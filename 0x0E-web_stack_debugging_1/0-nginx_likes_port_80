#!/usr/bin/env bash
# This script fixes the issue of Nginx not listening on port 80 by adjusting its configuration

# Update package lists
apt-get update

# Install necessary packages for debugging
apt-get install -y net-tools curl

# Check if Nginx is running
nginx_status=$(service nginx status)

if [[ $nginx_status == *"not running"* ]]; then
    # If Nginx is not running, start it
    service nginx start
fi

# Check Nginx configuration for listening on port 80
if ! grep -q "listen 80;" /etc/nginx/sites-available/default; then
    # If not configured, add it
    sed -i '/listen 80 default_server;/a \\tlisten 80;' /etc/nginx/sites-available/default
fi

# Restart Nginx to apply changes
service nginx restart

